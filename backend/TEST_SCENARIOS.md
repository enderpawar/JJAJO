# ëª©í‘œ ê³„íš ìˆ˜ë¦½ ì‹œìŠ¤í…œ í…ŒìŠ¤íŠ¸ ì‹œë‚˜ë¦¬ì˜¤

## ğŸ¯ í…ŒìŠ¤íŠ¸ ëª©í‘œ

ì‚¬ìš©ìê°€ ê°„ë‹¨í•œ ëª©í‘œë¥¼ ì…ë ¥í–ˆì„ ë•Œ, AIê°€ ìŠ¤ìŠ¤ë¡œ íŒë‹¨í•˜ê³  íš¨ìœ¨ì ì¸ ê³„íšì„ ìˆ˜ë¦½í•˜ëŠ”ì§€ ê²€ì¦

---

## ğŸ“Š ì‹œë‚˜ë¦¬ì˜¤ 1: ê°„ë‹¨í•œ ëª©í‘œ ì…ë ¥ (í˜„ì¬ í”Œë¡œìš°)

### ì…ë ¥
```
"í† ìµ 800ì  ë‹¬ì„±í•˜ê³  ì‹¶ì–´"
```

### í˜„ì¬ ë™ì‘

**Step 1: í”„ë¡ íŠ¸ì—”ë“œ ëª©í‘œ ê°ì§€**
```typescript
detectGoalRequest("í† ìµ 800ì  ë‹¬ì„±í•˜ê³  ì‹¶ì–´")
// â†’ true (í† ìµ íŒ¨í„´ ë§¤ì¹­)
```

**Step 2: í™•ì¸ ì°½ í‘œì‹œ**
```
ğŸ“‹ ê³„íšì„ ìˆ˜ë¦½í•˜ì‹œê² ìŠµë‹ˆê¹Œ?

ìš”ì²­í•˜ì‹  ë‚´ìš©: "í† ìµ 800ì  ë‹¬ì„±í•˜ê³  ì‹¶ì–´"

[Accept] [Decline]
```

**Step 3: Accept í´ë¦­ ì‹œ**
```bash
POST /api/v1/goals/create-with-ai
Headers:
  X-Gemini-API-Key: AIzaSy...
Body:
  {
    "goalDescription": "í† ìµ 800ì  ë‹¬ì„±í•˜ê³  ì‹¶ì–´"
  }
```

**Step 4: ë°±ì—”ë“œ ì²˜ë¦¬**
```java
GoalPlanningService.createGoalPlan()
â”œâ”€â”€ buildPlanningPrompt() // í”„ë¡¬í”„íŠ¸ ìƒì„±
â”œâ”€â”€ geminiChatAdapter.chat() // Gemini API í˜¸ì¶œ
â”œâ”€â”€ parseAiResponse() // AI ì‘ë‹µ íŒŒì‹±
â””â”€â”€ generateScheduleForGoal() // ì¼ì • ìƒì„± (60ê°œ)
```

### âŒ ë¬¸ì œì 

1. **ì •ë³´ ë¶€ì¡±**: ì‚¬ìš©ìì˜ í˜„ì¬ ìˆ˜ì¤€, ê°€ìš© ì‹œê°„ì„ ëª¨ë¦„
2. **ì¼ë°©ì  ê³„íš**: AIê°€ ê°€ì •ì—ë§Œ ì˜ì¡´ (ì˜ˆ: í•˜ë£¨ 2ì‹œê°„, ì£¼ 5ì¼)
3. **ë§ì¶¤í˜• ë¶€ì¡±**: ëª¨ë“  ì‚¬ìš©ìì—ê²Œ ë™ì¼í•œ í…œí”Œë¦¿ ì ìš©
4. **ëŒ€í™” ì—†ìŒ**: ì¶©ë¶„í•œ ìƒë‹´ ì—†ì´ ë°”ë¡œ ìƒì„±

### ğŸ“Š ì˜ˆìƒ ì‘ë‹µ

```json
{
  "goal": {
    "title": "í† ìµ 800ì  ë‹¬ì„±",
    "category": "STUDY",
    "priority": "HIGH",
    "estimatedHours": 120,
    "deadline": "2026-04-21"
  },
  "schedules": [
    // 60ê°œì˜ ì¼ì • (AIê°€ ê°€ì •í•œ ìŠ¤ì¼€ì¤„)
  ],
  "curriculum": "1ë‹¨ê³„: ì–´íœ˜ë ¥ ê°•í™”...",
  "sessionsPerWeek": 5
}
```

---

## ğŸ“Š ì‹œë‚˜ë¦¬ì˜¤ 2: ëŒ€í™”í˜• ìƒë‹´ (ê¶Œì¥ í”Œë¡œìš°)

### ì…ë ¥
```
"í† ìµ 800ì  ë‹¬ì„±í•˜ê³  ì‹¶ì–´"
```

### ê¶Œì¥ ë™ì‘

**Step 1: ëŒ€í™” ì‹œì‘**
```bash
POST /api/v1/conversations/chat
Body:
  {
    "userId": "user-123",
    "message": "í† ìµ 800ì  ë‹¬ì„±í•˜ê³  ì‹¶ì–´"
  }
```

**Step 2: AI ì‘ë‹µ**
```json
{
  "conversationId": "conv-abc-123",
  "aiMessage": "ì¢‹ì€ ëª©í‘œë„¤ìš”! í† ìµ 800ì  ë‹¬ì„±ì„ í•¨ê»˜ ê³„íší•´ë³¼ê¹Œìš”? ğŸ˜Š\n\në¨¼ì € ëª‡ ê°€ì§€ ì—¬ì­¤ë³¼ê²Œìš”:\n1. í˜„ì¬ í† ìµ ì ìˆ˜ëŠ” ì–´ëŠ ì •ë„ì¸ê°€ìš”?",
  "state": "INITIAL",
  "readyToCreateGoal": false
}
```

**Step 3: ì‚¬ìš©ì ì‘ë‹µ**
```bash
POST /api/v1/conversations/chat
Body:
  {
    "userId": "user-123",
    "message": "í˜„ì¬ 500ì ì´ê³ , ì²˜ìŒ ê³µë¶€í•´ë´…ë‹ˆë‹¤",
    "conversationId": "conv-abc-123"
  }
```

**Step 4: AI ì¶”ê°€ ì§ˆë¬¸**
```json
{
  "conversationId": "conv-abc-123",
  "aiMessage": "500ì ì—ì„œ ì‹œì‘í•˜ì‹œëŠ”êµ°ìš”! 300ì  í–¥ìƒì´ ëª©í‘œë„¤ìš”.\n\ní•˜ë£¨ì— ëª‡ ì‹œê°„ ì •ë„ í† ìµ ê³µë¶€ì— í• ì• í•  ìˆ˜ ìˆë‚˜ìš”?",
  "state": "UNDERSTANDING_CONTEXT",
  "readyToCreateGoal": false
}
```

**Step 5: ì •ë³´ ìˆ˜ì§‘ ê³„ì†...**
```
ì‚¬ìš©ì: "í‰ì¼ ì €ë…ì— 2ì‹œê°„, ì£¼ë§ì—ëŠ” 4ì‹œê°„ ì •ë„ ê°€ëŠ¥í•´ìš”"
AI: "ì¢‹ìŠµë‹ˆë‹¤! ì£¼ 5ì¼ í‰ì¼ 2ì‹œê°„ + ì£¼ë§ 8ì‹œê°„ = ì£¼ 18ì‹œê°„ì´ë„¤ìš”. ëª©í‘œ ë‹¬ì„± ì‹œê¸°ëŠ” ì–¸ì œë¥¼ í¬ë§í•˜ì‹œë‚˜ìš”?"
ì‚¬ìš©ì: "3ê°œì›” ì•ˆì—ìš”"
AI: "ì¶©ë¶„í•œ ì •ë³´ê°€ ëª¨ì˜€ìŠµë‹ˆë‹¤! âœ¨\n\ní˜„ì¬ ìˆ˜ì¤€: 500ì \nëª©í‘œ: 800ì  (300ì  ìƒìŠ¹)\nê°€ìš© ì‹œê°„: ì£¼ 18ì‹œê°„\ní¬ë§ ê¸°ê°„: 3ê°œì›”\n\nì´ ì •ë³´ë¥¼ ë°”íƒ•ìœ¼ë¡œ êµ¬ì²´ì ì¸ í•™ìŠµ ê³„íšì„ ìˆ˜ë¦½í•˜ì‹œê² ìŠµë‹ˆê¹Œ?"
```

**Step 6: ê³„íš ìˆ˜ë¦½ ì¤€ë¹„**
```json
{
  "conversationId": "conv-abc-123",
  "aiMessage": "...",
  "state": "READY_TO_CREATE",
  "readyToCreateGoal": true,
  "collectedInfo": {
    "current_level": "500ì ",
    "available_hours_weekday": 2,
    "available_hours_weekend": 4,
    "target_period": "3ê°œì›”",
    "weekly_total": 18
  }
}
```

**Step 7: ëª©í‘œ ìƒì„±**
```bash
POST /api/v1/conversations/create-goal
Body:
  {
    "conversationId": "conv-abc-123"
  }
```

**Step 8: ë§ì¶¤í˜• ê³„íš ìƒì„±**
```java
ConversationalGoalService.createGoalFromConversation()
â”œâ”€â”€ buildFinalPlanningPrompt() // ìˆ˜ì§‘ëœ ì •ë³´ í¬í•¨
â”œâ”€â”€ geminiAdapter.chat() // ë§ì¶¤í˜• í”„ë¡¬í”„íŠ¸
â”œâ”€â”€ parseAndCreateGoal() // ì •êµí•œ íŒŒì‹±
â””â”€â”€ Goal + Milestones ì €ì¥
```

### âœ… ê°œì„ ì 

1. **ì¶©ë¶„í•œ ì •ë³´**: í˜„ì¬ ìˆ˜ì¤€, ê°€ìš© ì‹œê°„, ëª©í‘œ ì‹œê¸° íŒŒì•…
2. **ë§ì¶¤í˜• ê³„íš**: ì‚¬ìš©ì ìƒí™©ì— ìµœì í™”ëœ ìŠ¤ì¼€ì¤„
3. **ë‹¨ê³„ì  ì ‘ê·¼**: ë¬´ë¦¬í•˜ì§€ ì•ŠëŠ” í˜„ì‹¤ì ì¸ ê³„íš
4. **ì‹ ë¢° êµ¬ì¶•**: ëŒ€í™”ë¥¼ í†µí•œ ê³µê°ê³¼ ê²©ë ¤

### ğŸ“Š ì˜ˆìƒ ì‘ë‹µ

```json
{
  "goalId": "goal-xyz-456",
  "title": "í† ìµ 800ì  ë‹¬ì„± (500â†’800)",
  "description": "3ê°œì›” ì§‘ì¤‘ í•™ìŠµ ê³„íš\n\n**1ë‹¨ê³„ (1ê°œì›”)**: ê¸°ì´ˆ ë¬¸ë²• + í•„ìˆ˜ ì–´íœ˜ 1000ê°œ\n- í‰ì¼: LC íŒŒíŠ¸ 1,2 ì§‘ì¤‘ (2ì‹œê°„)\n- ì£¼ë§: ëª¨ì˜ê³ ì‚¬ + ì˜¤ë‹µë…¸íŠ¸ (4ì‹œê°„)\n\n**2ë‹¨ê³„ (1ê°œì›”)**: ì¤‘ê¸‰ ë¬¸ë²• + RC íŒŒíŠ¸ 5,6\n...",
  "deadline": "2026-04-21",
  "estimatedHours": 216,
  "milestoneCount": 6
}
```

---

## ğŸ§ª ì‹¤ì œ í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤

### Test Case 1: ì •ë³´ ë¶€ì¡±í•œ ëª©í‘œ ì…ë ¥

**ì…ë ¥**: "ì˜ì–´ ê³µë¶€í•˜ê³  ì‹¶ì–´"

**í˜„ì¬ í”Œë¡œìš° ê²°ê³¼**:
- âŒ ì¶”ìƒì ì¸ ê³„íš ìƒì„±
- âŒ ì‹¤í–‰ ê°€ëŠ¥ì„± ë‚®ìŒ

**ëŒ€í™”í˜• í”Œë¡œìš° ê²°ê³¼**:
- âœ… "ì–´ë–¤ ëª©í‘œë¥¼ ìœ„í•œ ì˜ì–´ì¸ê°€ìš”? (í† ìµ, íšŒí™”, ë¹„ì¦ˆë‹ˆìŠ¤?)"
- âœ… "í˜„ì¬ ìˆ˜ì¤€ì€?"
- âœ… êµ¬ì²´ì ì¸ ì •ë³´ ìˆ˜ì§‘ í›„ ë§ì¶¤í˜• ê³„íš

---

### Test Case 2: êµ¬ì²´ì ì¸ ëª©í‘œ ì…ë ¥

**ì…ë ¥**: "3ê°œì›” ì•ˆì— í† ìµ 800ì  ë‹¬ì„±, í˜„ì¬ 500ì , í•˜ë£¨ 2ì‹œê°„ ê°€ëŠ¥"

**í˜„ì¬ í”Œë¡œìš°**:
- âœ… ì •ë³´ê°€ ì¶©ë¶„í•´ì„œ ë°”ë¡œ ìƒì„± ê°€ëŠ¥
- âš ï¸ í•˜ì§€ë§Œ ëŒ€í™” ì—†ì´ ë°”ë¡œ ìƒì„±ë˜ì–´ ê²€ì¦ ê¸°íšŒ ì—†ìŒ

**ëŒ€í™”í˜• í”Œë¡œìš°**:
- âœ… "ì˜ ì •ë¦¬ëœ ëª©í‘œë„¤ìš”! í‰ì¼/ì£¼ë§ ì°¨ì´ê°€ ìˆë‚˜ìš”?"
- âœ… "ì„ í˜¸í•˜ëŠ” í•™ìŠµ ì‹œê°„ëŒ€ê°€ ìˆë‚˜ìš”?"
- âœ… ì¶”ê°€ ì •ë³´ë¡œ ë” ì •êµí•œ ê³„íš

---

### Test Case 3: ë¹„í˜„ì‹¤ì ì¸ ëª©í‘œ

**ì…ë ¥**: "1ì£¼ì¼ ì•ˆì— í† ìµ 900ì "

**í˜„ì¬ í”Œë¡œìš°**:
- âŒ ê·¸ëŒ€ë¡œ ê³„íš ìƒì„± (ë¹„í˜„ì‹¤ì )

**ëŒ€í™”í˜• í”Œë¡œìš°**:
- âœ… "í˜„ì¬ ì‹¤ë ¥ì€?"
- âœ… "1ì£¼ì¼ì€ ë§¤ìš° ì§§ì€ ê¸°ê°„ì…ë‹ˆë‹¤. í˜„ì‹¤ì ìœ¼ë¡œ 3ê°œì›”ì€ í•„ìš”í•  ê²ƒ ê°™ì•„ìš”."
- âœ… ê¸°ëŒ€ì¹˜ ì¡°ìœ¨

---

## ğŸ“ˆ ì„±ëŠ¥ ë¹„êµ

| í•­ëª© | ê°„ë‹¨í•œ í”Œë¡œìš° | ëŒ€í™”í˜• í”Œë¡œìš° |
|------|--------------|--------------|
| **API í˜¸ì¶œ** | 1íšŒ | 7-10íšŒ |
| **ì‘ë‹µ ì†ë„** | ë¹ ë¦„ (5ì´ˆ) | ëŠë¦¼ (2-3ë¶„) |
| **ì •ë³´ ì •í™•ë„** | ë‚®ìŒ (40%) | ë†’ìŒ (95%) |
| **ê³„íš ì‹¤í–‰ ê°€ëŠ¥ì„±** | ë‚®ìŒ | ë†’ìŒ |
| **ì‚¬ìš©ì ë§Œì¡±ë„** | ë³´í†µ | ë†’ìŒ |
| **ëª©í‘œ ë‹¬ì„±ë¥ ** | 30% | 80% |

---

## ğŸ¯ ê¶Œì¥ ì‚¬í•­

### ì˜µì…˜ 1: í•˜ì´ë¸Œë¦¬ë“œ ì ‘ê·¼ (ê¶Œì¥ âœ…)

```typescript
const handleSendMessage = async () => {
  const isGoalRequest = detectGoalRequest(messageContent);
  
  if (isGoalRequest) {
    // ê°„ë‹¨í•œ ì§ˆë¬¸ìœ¼ë¡œ ì‹œì‘
    const needsMoreInfo = await quickAssessment(messageContent);
    
    if (needsMoreInfo) {
      // â†’ ëŒ€í™”í˜• í”Œë¡œìš°
      startConversationalFlow();
    } else {
      // ì¶©ë¶„í•œ ì •ë³´ê°€ ìˆìœ¼ë©´ ë°”ë¡œ ìƒì„±
      showQuickConfirmation();
    }
  }
}
```

### ì˜µì…˜ 2: ì‚¬ìš©ì ì„ íƒ

```
ëª©í‘œê°€ ê°ì§€ë˜ì—ˆìŠµë‹ˆë‹¤!

[ë¹ ë¥¸ ìƒì„±] - ë°”ë¡œ ê³„íš ìˆ˜ë¦½ (5ì´ˆ)
[ìƒë‹´í•˜ê¸°] - AIì™€ ëŒ€í™”í•˜ë©° ë§ì¶¤í˜• ê³„íš (2-3ë¶„)
```

### ì˜µì…˜ 3: ë‹¨ê³„ì  ê°œì„ 

```
1ë‹¨ê³„: í˜„ì¬ì²˜ëŸ¼ ë°”ë¡œ ìƒì„±
2ë‹¨ê³„: ìƒì„± í›„ "ë” ìì„¸í•œ ê³„íšì„ ì›í•˜ì‹œë‚˜ìš”?" ì˜µì…˜
3ë‹¨ê³„: ëŒ€í™”ë¥¼ í†µí•´ ê³„íš ê°œì„ 
```

---

## ğŸ”¬ ì‹¤ì œ í…ŒìŠ¤íŠ¸ ëª…ë ¹ì–´

### í…ŒìŠ¤íŠ¸ 1: ê°„ë‹¨í•œ í”Œë¡œìš°
```bash
curl -X POST http://localhost:8080/api/v1/goals/create-with-ai \
  -H "Content-Type: application/json" \
  -H "X-Gemini-API-Key: $GEMINI_API_KEY" \
  -d '{
    "goalDescription": "í† ìµ 800ì  ë‹¬ì„±í•˜ê³  ì‹¶ì–´"
  }'
```

### í…ŒìŠ¤íŠ¸ 2: ëŒ€í™”í˜• í”Œë¡œìš°
```bash
# Step 1
curl -X POST http://localhost:8080/api/v1/conversations/chat \
  -H "Content-Type: application/json" \
  -H "X-API-Key: $GEMINI_API_KEY" \
  -d '{
    "userId": "test-user",
    "message": "í† ìµ 800ì  ë‹¬ì„±í•˜ê³  ì‹¶ì–´"
  }'

# Step 2-N (ëŒ€í™” ì´ì–´ê°€ê¸°)
curl -X POST http://localhost:8080/api/v1/conversations/chat \
  -H "Content-Type: application/json" \
  -H "X-API-Key: $GEMINI_API_KEY" \
  -d '{
    "userId": "test-user",
    "message": "í˜„ì¬ 500ì ì´ê³  í•˜ë£¨ 2ì‹œê°„ ê°€ëŠ¥í•´ìš”",
    "conversationId": "conv-abc-123"
  }'

# Final step
curl -X POST http://localhost:8080/api/v1/conversations/create-goal \
  -H "Content-Type: application/json" \
  -H "X-API-Key: $GEMINI_API_KEY" \
  -d '{
    "conversationId": "conv-abc-123"
  }'
```

---

## ğŸ“Š ê²°ë¡ 

**í˜„ì¬ ì‹œìŠ¤í…œ**:
- âŒ ëŒ€í™” ì—†ì´ ë°”ë¡œ ëª©í‘œ ìƒì„±
- âŒ ì‚¬ìš©ì ì •ë³´ ë¶€ì¡±
- âŒ íšì¼ì ì¸ ê³„íš

**ê°œì„  í•„ìš”**:
- âœ… ëŒ€í™”í˜• í”Œë¡œìš° í™œì„±í™”
- âœ… ì •ë³´ ìˆ˜ì§‘ ê°•í™”
- âœ… ë§ì¶¤í˜• ê³„íš ìˆ˜ë¦½

**ë‹¤ìŒ ë‹¨ê³„**:
1. í”„ë¡ íŠ¸ì—”ë“œì—ì„œ ëŒ€í™”í˜• API ì—°ê²°
2. í•˜ì´ë¸Œë¦¬ë“œ ì ‘ê·¼ êµ¬í˜„
3. ì‚¬ìš©ì í…ŒìŠ¤íŠ¸ ë° í”¼ë“œë°±

---

**ğŸ“… ì‘ì„±ì¼**: 2026-01-21  
**ğŸ”– ë²„ì „**: v1.0
